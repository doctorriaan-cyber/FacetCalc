<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Block Mixture Calculator</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Custom style to ensure body covers full screen and no horizontal scrolling -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        .gender-button.selected {
            background-color: #3b82f6; /* A slightly darker blue for selected state */
            color: white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            border-color: #2563eb;
        }
        /* Custom styles for the new buttons */
        .select-button {
            transition: background-color 0.2s, color 0.2s;
        }
        .select-button.selected {
            background-color: #3b82f6;
            color: white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        /* Style for the collapsible container and its content */
        .collapsible-header {
            cursor: pointer;
            user-select: none;
            transition: background-color 0.2s;
        }
        .collapsible-content {
            overflow: hidden;
            max-height: 0;
            transition: max-height 0.3s ease-out;
        }
        .collapsible-content.open {
            max-height: 800px; /* Increased from 500px to ensure all options are visible */
            transition: max-height 0.5s ease-in;
        }
        .chevron {
            transition: transform 0.3s;
        }
        .chevron.open {
            transform: rotate(180deg);
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 flex items-start justify-center min-h-screen p-4 relative overflow-y-auto">

    <!-- Burger Menu Overlay -->
    <div id="menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 hidden z-40 transition-opacity duration-300"></div>

    <!-- Burger Menu Container -->
    <div id="menu-container" class="fixed top-0 left-0 w-64 h-full bg-gray-800 shadow-xl z-50 transform -translate-x-full transition-transform duration-300 p-6 flex flex-col">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-xl font-bold">Settings</h2>
            <button id="menu-close-btn" class="text-gray-400 hover:text-white transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        
        <!-- Menu Items Container with scrolling -->
        <div class="flex-grow overflow-y-auto">
            <!-- Max Lignocaine dose -->
            <div class="flex items-center justify-between mb-4">
                <label for="lignocaine-dose" class="text-sm font-semibold text-gray-300">Max Lignocaine dose</label>
                <div class="flex items-center space-x-2">
                    <input type="number" id="lignocaine-dose" value="4.5" step="0.1" class="w-20 px-2 py-1 bg-gray-700 rounded-md text-white text-right focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="text-sm text-gray-400">mg/kg</span>
                </div>
            </div>
            
            <!-- Max Dexamethazone ampules -->
            <div class="flex items-center justify-between mb-4">
                <label for="dexamethazone-ampules" class="text-sm font-semibold text-gray-300">Max Dexamethazone ampules</label>
                <div class="flex items-center space-x-2">
                    <input type="number" id="dexamethazone-ampules" value="3" step="1" class="w-20 px-2 py-1 bg-gray-700 rounded-md text-white text-right focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="text-sm text-gray-400">ampules</span>
                </div>
            </div>

            <!-- C volume -->
            <div class="flex items-center justify-between mb-4">
                <label for="c-volume" class="text-sm font-semibold text-gray-300">C volume</label>
                <div class="flex items-center space-x-2">
                    <input type="number" id="c-volume" value="2" step="1" class="w-20 px-2 py-1 bg-gray-700 rounded-md text-white text-right focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="text-sm text-gray-400">ml</span>
                </div>
            </div>

            <!-- L volume -->
            <div class="flex items-center justify-between mb-4">
                <label for="l-volume" class="text-sm font-semibold text-gray-300">L volume</label>
                <div class="flex items-center space-x-2">
                    <input type="number" id="l-volume" value="3" step="1" class="w-20 px-2 py-1 bg-gray-700 rounded-md text-white text-right focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="text-sm text-gray-400">ml</span>
                </div>
            </div>

            <!-- S volume -->
            <div class="flex items-center justify-between mb-4">
                <label for="s-volume" class="text-sm font-semibold text-gray-300">S volume</label>
                <div class="flex items-center space-x-2">
                    <input type="number" id="s-volume" value="3" step="1" class="w-20 px-2 py-1 bg-gray-700 rounded-md text-white text-right focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="text-sm text-gray-400">ml</span>
                </div>
            </div>

            <!-- GONS volume -->
            <div class="flex items-center justify-between mb-4">
                <label for="gons-volume" class="text-sm font-semibold text-gray-300">GONS volume</label>
                <div class="flex items-center space-x-2">
                    <input type="number" id="gons-volume" value="4" step="1" class="w-20 px-2 py-1 bg-gray-700 rounded-md text-white text-right focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="text-sm text-gray-400">ml</span>
                </div>
            </div>

            <!-- Shoulder volume -->
            <div class="flex items-center justify-between mb-4">
                <label for="shoulder-volume" class="text-sm font-semibold text-gray-300">Shoulder volume</label>
                <div class="flex items-center space-x-2">
                    <input type="number" id="shoulder-volume" value="4" step="1" class="w-20 px-2 py-1 bg-gray-700 rounded-md text-white text-right focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="text-sm text-gray-400">ml</span>
                </div>
            </div>

            <!-- Hip volume -->
            <div class="flex items-center justify-between mb-4">
                <label for="hip-volume" class="text-sm font-semibold text-gray-300">Hip volume</label>
                <div class="flex items-center space-x-2">
                    <input type="number" id="hip-volume" value="4" step="1" class="w-20 px-2 py-1 bg-gray-700 rounded-md text-white text-right focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="text-sm text-gray-400">ml</span>
                </div>
            </div>

            <!-- Ankle volume -->
            <div class="flex items-center justify-between mb-4">
                <label for="ankle-volume" class="text-sm font-semibold text-gray-300">Ankle volume</label>
                <div class="flex items-center space-x-2">
                    <input type="number" id="ankle-volume" value="4" step="1" class="w-20 px-2 py-1 bg-gray-700 rounded-md text-white text-right focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <span class="text-sm text-gray-400">ml</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="w-full max-w-sm mx-auto bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg border border-gray-700 relative z-30">
        <!-- Settings button -->
        <button id="settings-btn" class="absolute top-4 left-4 text-gray-400 hover:text-white transition-colors z-50">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
        </button>

        <!-- Heading -->
        <h1 class="text-2xl sm:text-3xl font-extrabold text-center mb-8 text-white">Block Mixture Calculator</h1>

        <!-- Weight Selector Section -->
        <div class="mb-8">
            <h2 class="text-lg font-semibold text-center mb-4">Actual weight</h2>
            <div class="flex items-center justify-center space-x-2 sm:space-x-4">
                
                <!-- Subtract 10kg Button -->
                <button id="subtract10" class="flex items-center justify-center w-14 h-10 sm:w-18 sm:h-14 rounded-full bg-blue-600 text-white shadow-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 active:bg-blue-800" aria-label="Subtract 10 kilograms">
                    <span class="text-sm sm:text-md font-bold p-1">-10</span>
                </button>
                
                <!-- Subtract 1kg Button -->
                <button id="subtract1" class="flex items-center justify-center w-14 h-10 sm:w-18 sm:h-14 rounded-full bg-blue-500 text-white shadow-md hover:bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75 active:bg-blue-700" aria-label="Subtract 1 kilogram">
                    <span class="text-sm sm:text-md font-bold p-1">-1</span>
                </button>
                
                <!-- Weight Display Box -->
                <div id="weightDisplay" class="flex items-center justify-center w-28 h-16 sm:w-40 sm:h-20 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                    <span class="text-xl sm:text-3xl font-extrabold text-white select-none">70kg</span>
                </div>
                
                <!-- Add 1kg Button -->
                <button id="add1" class="flex items-center justify-center w-14 h-10 sm:w-18 sm:h-14 rounded-full bg-blue-500 text-white shadow-md hover:bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75 active:bg-blue-700" aria-label="Add 1 kilogram">
                    <span class="text-sm sm:text-md font-bold p-1">+1</span>
                </button>
                
                <!-- Add 10kg Button -->
                <button id="add10" class="flex items-center justify-center w-14 h-10 sm:w-18 sm:h-14 rounded-full bg-blue-600 text-white shadow-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 active:bg-blue-800" aria-label="Add 10 kilograms">
                    <span class="text-sm sm:text-md font-bold p-1">+10</span>
                </button>
            </div>
        </div>

        <!-- Height Selector Section with BMI squeezed in -->
        <div class="mb-8">
            <!-- Grid layout for the heading and BMI display -->
            <div class="grid grid-cols-3 items-end mb-4">
                <!-- Empty div to push Height to center -->
                <div></div>
                <!-- Height heading, centered in its column -->
                <h2 class="text-lg font-semibold text-center">Height</h2>
                <!-- BMI display, justified to the right in its column -->
                <div class="flex justify-end">
                    <div class="px-1 rounded border border-gray-500 bg-gray-700">
                        <div class="text-xs text-gray-400">
                            <span id="bmiLabel">BMI:</span> <span id="bmiDisplay" class="font-medium text-white">--</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flex items-center justify-center space-x-2 sm:space-x-4">
                
                <!-- Subtract 10cm Button -->
                <button id="subtract10cm" class="flex items-center justify-center w-14 h-10 sm:w-18 sm:h-14 rounded-full bg-blue-600 text-white shadow-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 active:bg-blue-800" aria-label="Subtract 10 centimeters">
                    <span class="text-sm sm:text-md font-bold p-1">-10</span>
                </button>
                
                <!-- Subtract 1cm Button -->
                <button id="subtract1cm" class="flex items-center justify-center w-14 h-10 sm:w-18 sm:h-14 rounded-full bg-blue-500 text-white shadow-md hover:bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75 active:bg-blue-700" aria-label="Subtract 1 centimeter">
                    <span class="text-sm sm:text-md font-bold p-1">-1</span>
                </button>
                
                <!-- Height Display Box -->
                <div id="heightDisplay" class="flex items-center justify-center w-28 h-16 sm:w-40 sm:h-20 bg-gray-700 rounded-xl shadow-inner border border-gray-600">
                    <span class="text-xl sm:text-3xl font-extrabold text-white select-none">170cm</span>
                </div>
                
                <!-- Add 1cm Button -->
                <button id="add1cm" class="flex items-center justify-center w-14 h-10 sm:w-18 sm:h-14 rounded-full bg-blue-500 text-white shadow-md hover:bg-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-75 active:bg-blue-700" aria-label="Add 1 centimeter">
                    <span class="text-sm sm:text-md font-bold p-1">+1</span>
                </button>
                
                <!-- Add 10cm Button -->
                <button id="add10cm" class="flex items-center justify-center w-14 h-10 sm:w-18 sm:h-14 rounded-full bg-blue-600 text-white shadow-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 active:bg-blue-800" aria-label="Add 10 centimeters">
                    <span class="text-sm sm:text-md font-bold p-1">+10</span>
                </button>
            </div>
        </div>

        <!-- Gender Selector Section -->
        <div class="mb-8">
            <h2 class="text-lg font-semibold text-center mb-4">Gender</h2>
            <div class="flex items-center justify-center space-x-4">
                <button id="maleBtn" class="gender-button px-6 py-2 rounded-full bg-gray-700 text-gray-400 font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 selected">Male</button>
                <button id="femaleBtn" class="gender-button px-6 py-2 rounded-full bg-gray-700 text-gray-400 font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75">Female</button>
            </div>
        </div>

        <!-- Ideal Weight Section -->
        <div class="bg-gray-700 p-4 rounded-xl shadow-inner border border-gray-600 flex flex-col items-center mb-6">
            <h2 class="text-xl font-bold mb-4">Ideal weight</h2>
            <div class="flex items-center w-full justify-between">
                <!-- Button instead of a checkbox and label -->
                <button id="useIdealWeightBtn" class="px-3 py-1 rounded-full text-sm font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 bg-gray-600 text-gray-200">
                    Use Ideal Weight for calculations
                </button>
                <div id="idealWeightDisplay" class="flex items-center justify-center bg-gray-600 p-2 rounded-lg min-w-[100px]">
                    <span class="text-lg sm:text-xl font-extrabold text-white select-none">-- kg</span>
                </div>
            </div>
        </div>

        <!-- New Collapsible Sections -->
        
        <!-- Facet levels Section -->
        <div class="bg-gray-700 rounded-xl shadow-inner border border-gray-600 mb-6">
            <div id="facet-header" class="collapsible-header flex justify-between items-center p-4">
                <h3 class="text-lg font-semibold">Facet levels</h3>
                <svg id="facet-chevron" class="chevron h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
                </svg>
            </div>
            <div id="facet-content" class="collapsible-content p-4 border-t border-gray-600">
                <div class="flex flex-wrap gap-2">
                    <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C3-C7</button>
                    <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L1-S1</button>
                    <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">S1-S4</button>
                    <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">GONS</button>
                </div>
            </div>
        </div>
        
        <!-- Dorsal Roots Section -->
        <div class="bg-gray-700 rounded-xl shadow-inner border border-gray-600 mb-6">
            <div id="dorsal-roots-header" class="collapsible-header flex justify-between items-center p-4">
                <h3 class="text-lg font-semibold">Dorsal Roots</h3>
                <svg id="dorsal-roots-chevron" class="chevron h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
                </svg>
            </div>
            <div id="dorsal-roots-content" class="collapsible-content p-4 border-t border-gray-600">
                <div class="grid grid-cols-2 gap-2">
                    <div class="flex flex-col gap-2">
                        <h4 class="text-sm font-bold text-gray-400">Left</h4>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C3</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C4</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C5</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C6</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C7</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L1</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L2</button>
                    </div>
                    <div class="flex flex-col gap-2">
                        <h4 class="text-sm font-bold text-gray-400">Right</h4>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C3</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C4</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C5</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C6</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">C7</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L1</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L2</button>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-2 mt-2">
                     <div class="flex flex-col gap-2">
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L3</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L4</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L5</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">S1</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">S2</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">S3</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">S4</button>
                    </div>
                     <div class="flex flex-col gap-2">
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L3</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L4</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">L5</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">S1</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">S2</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">S3</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">S4</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Extra Section -->
        <div class="bg-gray-700 rounded-xl shadow-inner border border-gray-600 mb-6">
            <div id="extra-header" class="collapsible-header flex justify-between items-center p-4">
                <h3 class="text-lg font-semibold">Extra</h3>
                <svg id="extra-chevron" class="chevron h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
                </svg>
            </div>
            <div id="extra-content" class="collapsible-content p-4 border-t border-gray-600">
                <div class="grid grid-cols-2 gap-2">
                    <div class="flex flex-col gap-2">
                        <h4 class="text-sm font-bold text-gray-400">Left</h4>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">Shoulder</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">Hip</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">Knee</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">Ankle</button>
                    </div>
                    <div class="flex flex-col gap-2">
                        <h4 class="text-sm font-bold text-gray-400">Right</h4>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">Shoulder</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">Hip</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">Knee</button>
                        <button class="select-button px-4 py-2 rounded-full bg-gray-600 text-gray-200">Ankle</button>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <!-- JavaScript for functionality -->
    <script>
        // Use window.onload to ensure the DOM is fully loaded before the script runs
        window.onload = function() {
            // Get references to all the elements
            const weightDisplay = document.getElementById('weightDisplay').querySelector('span');
            const subtract10Btn = document.getElementById('subtract10');
            const subtract1Btn = document.getElementById('subtract1');
            const add1Btn = document.getElementById('add1');
            const add10Btn = document.getElementById('add10');
            
            const heightDisplay = document.getElementById('heightDisplay').querySelector('span');
            const subtract10cmBtn = document.getElementById('subtract10cm');
            const subtract1cmBtn = document.getElementById('subtract1cm');
            const add1cmBtn = document.getElementById('add1cm');
            const add10cmBtn = document.getElementById('add10cm');

            const maleBtn = document.getElementById('maleBtn');
            const femaleBtn = document.getElementById('femaleBtn');
            const idealWeightDisplay = document.getElementById('idealWeightDisplay').querySelector('span');
            const useIdealWeightBtn = document.getElementById('useIdealWeightBtn');

            // Get new BMI display element
            const bmiDisplay = document.getElementById('bmiDisplay');

            // Get menu elements
            const settingsBtn = document.getElementById('settings-btn');
            const menuContainer = document.getElementById('menu-container');
            const menuCloseBtn = document.getElementById('menu-close-btn');
            const menuOverlay = document.getElementById('menu-overlay');
            const lignocaineDoseInput = document.getElementById('lignocaine-dose');
            const dexamethasoneAmpulesInput = document.getElementById('dexamethazone-ampules');
            const cVolumeInput = document.getElementById('c-volume');
            const lVolumeInput = document.getElementById('l-volume');
            const sVolumeInput = document.getElementById('s-volume');
            const gonsVolumeInput = document.getElementById('gons-volume');
            const shoulderVolumeInput = document.getElementById('shoulder-volume');
            const hipVolumeInput = document.getElementById('hip-volume');
            const ankleVolumeInput = document.getElementById('ankle-volume');

            // New elements for collapsible sections
            const facetHeader = document.getElementById('facet-header');
            const facetContent = document.getElementById('facet-content');
            const facetChevron = document.getElementById('facet-chevron');
            const facetButtons = facetContent.querySelectorAll('.select-button');

            const dorsalRootsHeader = document.getElementById('dorsal-roots-header');
            const dorsalRootsContent = document.getElementById('dorsal-roots-content');
            const dorsalRootsChevron = document.getElementById('dorsal-roots-chevron');
            const dorsalRootsButtons = dorsalRootsContent.querySelectorAll('.select-button');

            const extraHeader = document.getElementById('extra-header');
            const extraContent = document.getElementById('extra-content');
            const extraChevron = document.getElementById('extra-chevron');
            const extraButtons = extraContent.querySelectorAll('.select-button');


            // Set the initial values and define the min/max limits
            let currentWeight = 70;
            const minWeight = 30;
            const maxWeight = 200;

            let currentHeight = 170;
            const minHeight = 80;
            const maxHeight = 250;
            let currentGender = 'male';

            // State variable for the new button
            let useIdealWeightForCalculation = false;

            // Function to update the weight display and BMI
            function updateWeightDisplay() {
                weightDisplay.textContent = `${currentWeight}kg`;
                calculateBMI();
            }

            // Function to handle weight changes with boundaries
            function changeWeight(change) {
                currentWeight += change;
                // Clamp the weight to the specified range
                if (currentWeight < minWeight) {
                    currentWeight = minWeight;
                }
                if (currentWeight > maxWeight) {
                    currentWeight = maxWeight;
                }
                updateWeightDisplay();
            }

            // Function to update the height display and re-calculate
            function updateHeightDisplay() {
                heightDisplay.textContent = `${currentHeight}cm`;
                calculateIdealWeight();
                calculateBMI();
            }

            // Function to handle height changes with boundaries
            function changeHeight(change) {
                currentHeight += change;
                // Clamp the height to the specified range
                if (currentHeight < minHeight) {
                    currentHeight = minHeight;
                }
                if (currentHeight > maxHeight) {
                    currentHeight = maxHeight;
                }
                updateHeightDisplay();
            }
            
            // Function to calculate and display ideal weight using Devine formula
            function calculateIdealWeight() {
                let idealWeight;
                const baseHeightCm = 152.4; // 60 inches in cm

                if (currentHeight > baseHeightCm) {
                    const heightDiffCm = currentHeight - baseHeightCm;
                    const increment = 0.91 * heightDiffCm;
                    if (currentGender === 'male') {
                        idealWeight = 50 + increment;
                    } else { // female
                        idealWeight = 45.5 + increment;
                    }
                } else {
                    idealWeight = (currentGender === 'male') ? 50 : 45.5;
                }

                idealWeightDisplay.textContent = `${idealWeight.toFixed(1)}kg`;
            }

            // Function to calculate and display BMI
            function calculateBMI() {
                // BMI = weight (kg) / [height (m)]^2
                const heightInMeters = currentHeight / 100;
                const bmi = currentWeight / (heightInMeters * heightInMeters);
                bmiDisplay.textContent = `${bmi.toFixed(1)}`;
            }

            // Function to handle gender selection
            function handleGenderSelection(selectedBtn, otherBtn, genderValue) {
                selectedBtn.classList.add('selected');
                otherBtn.classList.remove('selected');
                selectedBtn.classList.remove('bg-gray-700', 'text-gray-400');
                selectedBtn.classList.add('bg-blue-500', 'text-white');
                otherBtn.classList.add('bg-gray-700', 'text-gray-400');
                otherBtn.classList.remove('bg-blue-500', 'text-white');
                currentGender = genderValue;
                calculateIdealWeight();
            }

            // Function to toggle collapsible sections
            function toggleCollapsible(header, content, chevron) {
                const isOpen = content.classList.contains('open');
                if (isOpen) {
                    content.classList.remove('open');
                    chevron.classList.remove('open');
                } else {
                    content.classList.add('open');
                    chevron.classList.add('open');
                }
            }

            // Function to handle multi-selection button clicks
            function handleMultiSelect(clickedButton) {
                clickedButton.classList.toggle('selected');
                clickedButton.classList.toggle('bg-gray-600');
                clickedButton.classList.toggle('text-gray-200');
            }

            // Event listener for the -10kg button
            subtract10Btn.addEventListener('click', () => {
                changeWeight(-10);
            });

            // Event listener for the -1kg button
            subtract1Btn.addEventListener('click', () => {
                changeWeight(-1);
            });

            // Event listener for the +1kg button
            add1Btn.addEventListener('click', () => {
                changeWeight(1);
            });

            // Event listener for the +10kg button
            add10Btn.addEventListener('click', () => {
                changeWeight(10);
            });

            // Event listener for the -10cm button
            subtract10cmBtn.addEventListener('click', () => {
                changeHeight(-10);
            });

            // Event listener for the -1cm button
            subtract1cmBtn.addEventListener('click', () => {
                changeHeight(-1);
            });

            // Event listener for the +1cm button
            add1cmBtn.addEventListener('click', () => {
                changeHeight(1);
            });

            // Event listener for the +10cm button
            add10cmBtn.addEventListener('click', () => {
                changeHeight(10);
            });

            // Event listeners for gender buttons
            maleBtn.addEventListener('click', () => {
                handleGenderSelection(maleBtn, femaleBtn, 'male');
            });

            femaleBtn.addEventListener('click', () => {
                handleGenderSelection(femaleBtn, maleBtn, 'female');
            });
            
            // Event listener for the "Use Ideal Weight" button
            useIdealWeightBtn.addEventListener('click', () => {
                useIdealWeightForCalculation = !useIdealWeightForCalculation; // Toggle the state
                if (useIdealWeightForCalculation) {
                    useIdealWeightBtn.classList.remove('bg-gray-600', 'text-gray-200');
                    useIdealWeightBtn.classList.add('bg-blue-500', 'text-white');
                } else {
                    useIdealWeightBtn.classList.remove('bg-blue-500', 'text-white');
                    useIdealWeightBtn.classList.add('bg-gray-600', 'text-gray-200');
                }
            });

            // Event listeners for menu functionality
            settingsBtn.addEventListener('click', () => {
                menuContainer.classList.remove('-translate-x-full');
                menuOverlay.classList.remove('hidden');
            });

            menuCloseBtn.addEventListener('click', () => {
                menuContainer.classList.add('-translate-x-full');
                menuOverlay.classList.add('hidden');
            });

            menuOverlay.addEventListener('click', () => {
                menuContainer.classList.add('-translate-x-full');
                menuOverlay.classList.add('hidden');
            });

            // Event listeners for collapsible sections
            facetHeader.addEventListener('click', () => {
                toggleCollapsible(facetHeader, facetContent, facetChevron);
            });

            dorsalRootsHeader.addEventListener('click', () => {
                toggleCollapsible(dorsalRootsHeader, dorsalRootsContent, dorsalRootsChevron);
            });

            extraHeader.addEventListener('click', () => {
                toggleCollapsible(extraHeader, extraContent, extraChevron);
            });

            // Event listeners for new buttons. All new sections are multi-select
            facetButtons.forEach(button => {
                button.addEventListener('click', () => {
                    handleMultiSelect(button);
                });
            });

            dorsalRootsButtons.forEach(button => {
                button.addEventListener('click', () => {
                    handleMultiSelect(button);
                });
            });

            extraButtons.forEach(button => {
                button.addEventListener('click', () => {
                    handleMultiSelect(button);
                });
            });

            // Initial calculations on load
            updateWeightDisplay();
            updateHeightDisplay();
        };
    </script>
</body>
</html>
